#!/bin/bash

# If ACTIONS_ID_TOKEN_REQUEST_URL is set, we're in GitHub Actions - skip Azure DevOps setup
if [ -n "${ACTIONS_ID_TOKEN_REQUEST_URL}" ]; then
  source "$(dirname $0)"/resolve-shim.sh
  YARN_EXE="$(resolve_shim)"
  "${YARN_EXE}" "$@"
  exit $?
fi

source "$(dirname $0)"/auth-ado.sh
source "$(dirname $0)"/resolve-shim.sh

YARN_EXE="$(resolve_shim)"
ARTIFACTS_ACCESSTOKEN="${ARTIFACTS_ACCESSTOKEN:-}" ${YARN_EXE} "$@"